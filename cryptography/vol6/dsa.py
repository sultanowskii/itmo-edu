from gmpy2 import *

P = mpz('114767897203827877694262447483167584452317164189384087156181059384842594017952405391970924716516999511006587610347751360203628066197446962444295582673677846739281517790084939319551454461022330729130010595957666748060873933263237532647196923304502871139408268984186913470641861621374865268363692320723875925341')
Q = mpz('1367030756372682900636725826135219309175474587551')
G = mpz('26871182142080713299631604587840777332814039838819806135544518101625439449395765985269983045123546681277345260704507226869308981279397958832433744834884360445557990212101002092569904209583596015116043968223750866170148847395457248853255902601955065702304262820141741466991483875814098990500534986279881311019')
x = mpz('561450068476769700550936170816813158918283102321')
k = mpz('936800421112359141990793773190559216721425505957')
h_m = mpz('1041012704324150835652886655287508314496841564428')

Y = powmod(G, x, P)
print(f'{Y=}')

R = powmod(G, k, P) % Q
print(f'{R=}')

# 1/k % Q
k_inv = invert(k, Q)

S = ((h_m + x * R) * k_inv) % Q
print(f'{S=}')


